@model EnglishBattle.Models.GameViewModel

@{
    ViewBag.Title = "Game";
}

<h2>Game</h2>


@using (Html.BeginForm())
{

    <div class="form-horizontal">
        <h4>@ViewBag.congratulation</h4>
        <h3>Temps restant : <span id="countdownTimer"></span></h3>
        <h3>@ViewBag.infinitif</h3>
        <hr />
        @Html.ValidationSummary(true, "", new { @class = "text-danger" })
        <div class="form-group">
            @Html.LabelFor(model => model.Preterit, htmlAttributes: new { @class = "control-label col-md-2" })
            <div class="col-md-10">
                @Html.EditorFor(model => model.Preterit, new { htmlAttributes = new { @class = "form-control" } })
                @Html.ValidationMessageFor(model => model.Preterit, "", new { @class = "text-danger" })
            </div>
        </div>

        <div class="form-group">
            @Html.LabelFor(model => model.ParticipePasse, htmlAttributes: new { @class = "control-label col-md-2" })
            <div class="col-md-10">
                @Html.EditorFor(model => model.ParticipePasse, new { htmlAttributes = new { @class = "form-control" } })
                @Html.ValidationMessageFor(model => model.ParticipePasse, "", new { @class = "text-danger" })
            </div>
        </div>
        <div class="form-group">
            <div class="col-md-offset-2 col-md-10">
                <input type="submit" value="Valider" class="btn btn-default" id="validate" />
            </div>
        </div>
    </div>
}

<div>
    <p>Preterit : @Session["preterit"]</p>
    <p>Participe passé : @Session["participePasse"]</p>
    <p>Victoire : @Session["gameWinCount"]</p>
</div>


@section Scripts {
    @Scripts.Render("~/bundles/jqueryval")
}
<script>

    function countdown(duration, display) {
        let timer = duration, seconds;
        setInterval(() => {

            seconds = parseInt(timer % 60);
            seconds = seconds < 10 ? "0" + seconds : seconds;

            display.textContent = "00" + ":" + seconds;

            if (--timer < 0) {
                window.location='@Url.Action("EndGame","Game")'
            }
        }, 1000);
    }

    document.addEventListener('DOMContentLoaded', (event) => {
        window.onload = () => {
            htmlTag = document.getElementById('countdownTimer');
            countdown(60, htmlTag);
        };
    });

</script>
